---
title: "Investigating the Efficacy of a Novel Peptide in Inhibiting a Key Antibiotic Resistance Enzyme in *Escherichia coli*"
author: "Johanna Enright"
format: html
editor: visual
#code-fold: true
---

```{r setup}
knitr::opts_knit$set(root.dir = "C:/Documents/gradclasses/Rcourse/assignments/assignment6files/checkerboardfiles")
```

![](images/peptide.png){width="2in"}

## Background information

My data looks at *Escherichia coli* growth over a 24h period in a 96-well plate when treated with 2 drugs: ampicillin and a novel 14-amino acid peptide. The plate will have increasing concentration gradients of each drug along the x and y axis, respectively, along with an inoculum of bacteria (1 strain per plate) in each well.

![Figure 1. Checkerboard assay setup](images/checkerboard_setup.png)

The *E.coli* test strain contains an enzyme (TEM-1) that confers resistance to ampicillin. The novel peptide is proven to bind to and inhibit TEM-1 *in-vitro*, so we are seeing if it can also inhibit TEM-1 in bacterial cells.

For the test strain (*E.coli* PB9) which contains TEM-1 we are hoping to see that ampicillin's efficacy is restored with the addition of our peptide. If the peptide inhibits TEM-1, then TEM-1 is not available to degrade ampicillin, so ampicillin is able to enact its bacteriacidal effect by targeting a key enzyme in the bacterial cell wall.

![Figure 2. Proposed effect of peptide and ampicillin on key cell wall enzyme (PBP) in gram-negative bacteria.](images/peptide_mechanism_of_action.png)

Ideally, we hope to see that with increasing peptide concentrations, the amount of ampicillin required to kill the bacteria decreases. Additionally, there will be a control *E.coli* strain which does not have TEM-1. For this strain, we would expect to see only a response in growth to ampicillin and not peptide. It's growth across the plate should only change vertically with ampicillin concentration, and not horizontally with the peptide because it does not contain TEM-1 (the enzyme that we hope the peptide inhibits) so it is more susceptible to ampicillin. We will ultimately compare the growth patterns of the TEM-1 containing PB9 strain to that of the MG1655 control.

## Questions I hope to answer in my analysis:

-   does growth decrease with increasing ampicillin concentration?
-   does growth decrease with increasing peptide concentration?
-   do peptide and ampicillin together lower the amount of ampicillin that is required to inhibit bacterial growth?
-   is this change in decreased growth noticeable and different from the control?

## Analysis of data

#### Loading packages for analysis

```{r, message=FALSE, warning=FALSE}
library(tidyverse)
library(cowplot)
```

#### Reading in *E.coli* PB9 growth curve data & cleaning & wrangling it.

This data comes in the format with time, temperature and well columns. The well columns contain the OD600 (absorbance at 600nm wavelength) at each time point for each well.

```{r}
#| code-fold: true
OD_time_info <- read_csv("growthcurvedata/checkerboard_PB9_amp_EP6_250219_input.csv",
                         show_col_types = F) 
```

```{r}
names(OD_time_info)  #there are time, temperature, and well columns
head(OD_time_info$Time)  #Time column: time is given as hours:minutes:seconds
min(OD_time_info$Time) #starts at 22 seconds
max(OD_time_info$Time / 3600) #ends at 24h and 22s
#Note: the times are in time differences and not numeric.
length(OD_time_info$Time) #49 time readings (every 30min for 24h) as expected.
```

**Make new time column containing just the time in hours as a decimal:**

```{r}
#| code-fold: true
makenewtime <- function(df){
  df <- mutate(df, newtime = (as.numeric(df$Time) - df$Time[1]) / 3600)
  df$newtime <- as.numeric(df$newtime)  #recognized as a number, not a time in seconds
  return(df)
  #subtract the seconds because this will change slightly from plate to plate, depending on  how long the plate is shaken for (15 or 20s). Also divide by 3600s/h
}
OD_time_info <- makenewtime(OD_time_info) #column added
print(OD_time_info$newtime)   #looks good.
class(OD_time_info$newtime)
```

I will remove the temperature column which gives the temperature of the plate reader at each reading. This data will not be used.

```{r}
#| code-fold: true
OD_time_info <- OD_time_info[,-2]  #removing Temp column from data
```

**Now looking at the well columns.** These are represented as a column for each well (NOT TIDY!). Each column contains an OD600 reading.

```{r}
#| code-fold: true
OD_time_info[,2:ncol(OD_time_info)] %>% head() #each column contains an OD600 reading
```

**Double checking that each column has 49 readings and no NAs:**

```{r}
#| code-fold: true
checklength_and_NAs <- function(df){
  for (i in 2:97){
    #checking 49 readings
    if (as.numeric(nrow(df[,i]) != 49)){
      print(paste(
        "length of column", names(df[i]), "is not 49, it's", nrow(df[,i])))
    }
    #checking NAs
    if (sum(is.na(df[,i])) != 0){
      print(paste("column", names(df[i]), "has", sum(is.na(df[,i])), "NAs"))
    }
  }
}
checklength_and_NAs(OD_time_info)
#if nothing prints there are no problems.
```

looks good.

**Now convert table to long format.**

```{r}
#| code-fold: true
#convert to long format
pivotlong_gc <- function(df){
  df <- pivot_longer(df, cols = A1:H12, 
                      names_to = "well",
                      values_to = "OD600")
  print(df %>% head())
  print(paste("nrow: ", nrow(df)))  #this is good because 96 * 49 = 4704
  return(df)
}
long_OD_time_info <- pivotlong_gc(OD_time_info)
```

**Now Checking that there are no weird OD values:**

```{r}
#| code-fold: true
distributionOD <- function(df, title){
 plot <- df %>% 
        ggplot(aes(x = OD600)) +
        geom_histogram(fill = "#043927", bins = 40) +
        labs(title = title) +
        theme_light()
 return(plot)
}
distributionOD(long_OD_time_info, "Distribution of OD600 well readings for a 24h E.coli growth curve")
```

This is good. OD readings should be above 0, and not too far above 1. Also having a lot below 0.4 makes sense as not all wells will have growth and also many wells before the 10ish hour mark will have very minimal growth

**Now add 2 new columns: 'column' and 'row' which will be used later for graphing.**

```{r}
#| code-fold: true
addcolumnrow <- function(df){
  df <- mutate(df, row = substr(df$well, start = 1, stop = 1),
                     column = substr(df$well, start = 2, stop = length(df$well)) )
  
  #make it see column numbers as discrete variables (not contiuous), needed for graphing
  df$column <- factor(df$column, levels = df$column[1:12])  
  print(df %>% head()) #the 2 new columns are there
  return(df)
}
long_OD_time_info <- addcolumnrow(long_OD_time_info)  
```

looks good.

**Reading in drug concentration data**

Now I need to read in a new file 'PB9_drugconcs.csv'. This gives the ampicillin and peptide concentration used for each row or column (respectively) for this checkerboard. This information will need to be wrangled so it can be added to the PB9 growth curve data.

```{r}
#| code-fold: true
drugconcs <- read_csv("drugconcs/PB9_drugconcs.csv", show_col_types = F)  
print(drugconcs) #values in uM or ug/mL
```

we only need the uM columns, so ug/mL will be removed. We do not need to remove NAs because there are only 8 ampicillin rows which will be indexed for accordingly later.

```{r}
#| code-fold: true
drugconcs <- select(drugconcs, ampconc_uM, pepconc_uM) #remove ug/mL
print(drugconcs)
```

Now we will add these drug concentration values to their respective rows / columns in the original dataframe.

```{r}
#| code-fold: true
adddrugconcs <- function(dfgc, dfdc){
         dfgc <- dfgc %>%  mutate(amp_uM = case_when(
                            dfgc$row == "A" ~ dfdc$ampconc_uM[1],
                            dfgc$row == "B" ~ dfdc$ampconc_uM[2],
                            dfgc$row == "C" ~ dfdc$ampconc_uM[3],
                            dfgc$row == "D" ~ dfdc$ampconc_uM[4],
                            dfgc$row == "E" ~ dfdc$ampconc_uM[5],
                            dfgc$row == "F" ~ dfdc$ampconc_uM[6],
                            dfgc$row == "G" ~ dfdc$ampconc_uM[7],
                            dfgc$row == "H" ~ dfdc$ampconc_uM[8]),
          pep_uM = case_when(dfgc$column == 1 ~ dfdc$pepconc_uM[1],
                             dfgc$column == 2 ~ dfdc$pepconc_uM[2],
                             dfgc$column == 3 ~ dfdc$pepconc_uM[3],
                             dfgc$column == 4 ~ dfdc$pepconc_uM[4],
                             dfgc$column == 5 ~ dfdc$pepconc_uM[5],
                             dfgc$column == 6 ~ dfdc$pepconc_uM[6],
                             dfgc$column == 7 ~ dfdc$pepconc_uM[7],
                             dfgc$column == 8 ~ dfdc$pepconc_uM[8],
                             dfgc$column == 9 ~ dfdc$pepconc_uM[9],
                             dfgc$column == 10 ~ dfdc$pepconc_uM[10],
                             dfgc$column == 11 ~ dfdc$pepconc_uM[11],
                             dfgc$column == 12 ~ dfdc$pepconc_uM[12])
       )
  
    #make these concentrations factors, so the graphs will work properly later!
    #(discrete values!)
    dfgc$amp_uM   <- factor(dfgc$amp_uM, levels = dfgc$amp_uM[seq(1, 96, by=12)])
    dfgc$pep_uM   <- factor(dfgc$pep_uM, levels = na.omit(dfgc$pep_uM[1:12]))       
  
  print(dfgc %>% head())
  return(dfgc)
}
long_OD_time_info <- adddrugconcs(long_OD_time_info, drugconcs)   
```

It looks like the new columns have been added!

**Reading in background absorbance value data and wrangling**

Now we will read in the background OD600 data from a separate csv file. This is a single time OD600 reading plate with only media in it. It needs to be subtracted as background absorbance values from the growth curve data.

```{r}
#| code-fold: true
bgOD <- read_csv("background/camhb_bg_input.csv", show_col_types = F)
print(bgOD)
```

column names '...1' needs to be fixed for clarity. The other columns probably shouldn't have back ticks, but we won't be working with this data for long, so it is not necessary to fix them.

Now I will fix the name of column 1 and format the table so that it is tidy and in the right format to be subtracted from growth curve data.

```{r}
#| code-fold: true
bgOD <- rename(bgOD, row = ...1)   #fix name of column 1, rename it 'row'
#use pivot longer, so this data can be used with above OD_time data
bgOD <- pivot_longer(bgOD, cols = `1`:`12`,
             names_to = "column",
             values_to = "OD600")
print(head(bgOD))  #
```

looks good.

Add column 'well' so I can make sure the wells are in the same order as the growth curve data so that vectors line up before I subtract them.

```{r}
#| code-fold: true
bgOD <- mutate(bgOD, well = paste0(row, column))
bgOD[seq(1, 96, by = 12),] #looks good.
```

**Double checking the range of OD600 values from the background data:**

```{r}
#| code-fold: true
range(bgOD$OD600)
```

It is good that the range is small because all wells just contain media, so they are the same and should contain little variation. 0.1 is quite low too which is what we expect as there is no bacterial growth in this media control plate

**Checking the background and original growth curve data vectors align:**

```{r}
long_OD_time_info$well[1:96] == bgOD$well  
```

Yes, they do! This means they can be subtracted.

Now I will subtract the background absorbance values from the original absorbance values in the growth curve data.

```{r}
long_OD_time_info$OD600 <- long_OD_time_info$OD600 - bgOD$OD600
```

**Checking that the range after subtraction is good:**

```{r}
range(long_OD_time_info$OD600)  
```

Once background is subtracted, OD is mostly above 0. Being slightly below 0 is okay as long as it's not too far below, so all looks good here.

#### Initial look at the growth curve data

**Distribution by drug concentration plots**

Now that background has been subtracted and everything is tidy we will test the OD600 distributions by drug concentration. This will offer quick insight into if our test strain is responding to either drug individually.

```{r}
#| code-fold: true
distributionbyamp <- function(df, title){
  p1 <- df %>% 
     ggplot(aes(x = OD600, fill = amp_uM)) +
     geom_histogram(bins = 30) +
     labs(title = title, fill = "ampicillin \nconcentration (uM)") +
     theme_light()
  print(p1)
 }
  
 distributionbyamp(long_OD_time_info, 
                   title = "Distribution of OD600 well readings for growth curve \nby ampicillin concentration")
```

plot1: Overall, higher readings (i.e. more bacterial growth) appears to come more frequently from rows with lower ampicillin concentration which makes sense. The highest concentrations of ampicillin have the most counts at low OD readings which also makes sense

```{r}
#| code-fold: true
#testing distribution of OD600 by peptide conc.
distributionbypep <- function(df, title){
  p2 <- df %>%
    ggplot(aes(x = OD600, fill = pep_uM)) +
    geom_histogram(bins = 30) +
    labs(title = title, fill = "peptide \nconcentration (uM)") +
    theme_light()
  print(p2)
}
distributionbypep(long_OD_time_info,
                   title = "Distribution of OD600 well readings for growth curve \nby peptide concentration")
```

plot2: Overall, higher peptide concentrations have higher counts of low OD600 readings and vise versa! (this is good). It is not as drastic a difference as with ampicillin as the peptide is not bacteriacidal on its own.

**Testing that the drug concentrations and respective rows are the same**

```{r}
#| code-fold: true
rowAplot1 <- long_OD_time_info %>%     #testing plots on one row (row A)
              filter(row == "A") %>%       
              ggplot(aes(x = newtime, y = OD600, color = column, fill = column)) +
              geom_line() +
              labs(x = "Time (hours)", 
                   title = "24h growth curve of E.coli PB9 \nat ampicillin concentration 0 and varying peptide concs") +
              geom_point()
print(rowAplot1)
#shows OD generally goes down as columns (peptide conc) increases.

rowAplot2 <- long_OD_time_info %>%     #testing plots on one row (row A)
              filter(row == "A") %>%       
              ggplot(aes(x = newtime, y = OD600, color = pep_uM)) +
              geom_line() +
              labs(x = "Time (hours)", title = "24h growth curve of E.coli PB9 \nat ampicillin concentration 0 and varying peptide concs", color = "Peptide \nConc. (uM)") +
              geom_point()
print(rowAplot2)

```

These are the same plot. But I was just plotting them side by side to be sure that the drug concentrations aligned with the correct column numbers. And it looks that they have, given that the plots are the same.

Another thing to note from these plots is that the OD reading often starts off high and drops within the first hour. This is likely due to condensation under the plate lid as the plate gets up to temperature. Also could be from bubbles caused by the DMSO that the peptide is dissolved in. These generally pop over time when the plate is shaken every 30min. However this drop is kind of confusing to the overall trend, so going forward I will remove time points from the first hour, because they are not representative of actual bacterial growth.

**Growth curves for control column and row**

Next, I will remove first hour points to test that this looks good and plot the control column (0uM peptide) and control row (0uM ampicillin).

```{r}
#| code-fold: true
makesinglerowplotpep <- function(df, title){
  #no ampicillin row
  p1 <- df%>% 
    filter(amp_uM == 0 & newtime > 1) %>%       
    ggplot(aes(x = newtime, y = OD600, color = pep_uM)) +
    geom_point() +
    labs(x = "Time (hours)", color = "Peptide \nConcentration (uM)",  title = title) +
    geom_line() 
  print(p1)
}
makesinglerowplotpep(long_OD_time_info, 
            "24h growth curve of E.coli PB9 \nat ampicillin concentration 0")
```

```{r}
#| code-fold: true
makesinglerowplotamp <- function(df, title){
#no peptide column
  p2 <- df %>% 
    filter(pep_uM == 0 & newtime > 1) %>%       
    ggplot(aes(x = newtime, y = OD600, color = amp_uM)) +
    geom_point() +
    labs(x = "Time (hours)", 
         color = "ampicillin \nconc (uM)",
         title = title) +
    geom_line() 
  print(p2)
}
makesinglerowplotamp(long_OD_time_info, 
            "24h growth curve of E.coli PB9 \nat a peptide concentration of 0")
```

I think the plots look better with the 1st hour removed. There is also definitely a decrease in bacterial growth with increasing ampicillin concentration. This makes sense, given that ampicillin is a bacteriacidal agent. Overall, the OD600 also appears to go down as peptide concentration increases. This is strange considering the peptide is not bacteriacidal on its own and should rely on the presence of ampicillin to inhibit bacterial growth. So maybe the peptide does have some off target bacterialcidal properties to look into in the future for my project.

#### Growth Curve Plots for Whole Checkerboard

```{r}
#| code-fold: true
make_allwellgc <- function(df, title){
  allwellplot <- df %>% 
    filter(newtime > 1) %>% 
    ggplot(aes(x = newtime, y = OD600)) +
    geom_point(color = "blue", size = 0.2) +
    geom_line(color = "blue", linewidth = 0.5) +
    geom_area(fill = "lightblue") +

    labs(x = "Time (hours)", title = title) +
  
    facet_grid(amp_uM ~ pep_uM, scales = "fixed") + 
    scale_y_continuous(breaks = seq(0, 1.5, 0.5),
                       sec.axis = sec_axis(~ . , name = "Ampicillin Concentration (uM)",
                                           breaks = NULL, labels = NULL)) +
    scale_x_continuous(breaks = seq(0, 24, 4), 
                       sec.axis = sec_axis(~ . , name = "Peptide Concentration (uM)",
                                           breaks = NULL, labels = NULL)) +
  
  
    theme(
      axis.title.x = element_text(size = 12),  # Increase x-axis label
      axis.title.y = element_text(size = 12),   # Increase y-axis label 
      axis.text.x = element_text(size = 4),  # Increase x-axis scale values 
      axis.text.y = element_text(size = 6),   # Increase y-axis scale values
      axis.title.y.right = element_text(size = 12),
      axis.title.x.top = element_text(size = 12),
      plot.margin = unit(c(1, 1, 1, 1), "cm")
    ) 
  return(allwellplot)
}

allwellplot <- make_allwellgc(long_OD_time_info, "Growth curve of checkerboard assay for TEM-1 containing E.coli")
ggsave2(plot = allwellplot, filename = "plots/PB9_allwellplot.jpeg", width = 24, height = 16, units = "cm")
```

![](plots/PB9_allwellplot.jpeg) Overall, I think this is a promising sign that the peptide is working! As peptide increases, the general trend is lack of growth at lower ampicillin concentrations. For example at 0uM peptide, 4039uM of ampicillin is required to kill the bacteria. At 50uM of peptide, only 2423uM of peptide is required to kill the bacteria. At 70uM of peptide, only 808uM of peptide is required to inhibit growth!

Additionally, it would appear that there is an increase in lagtime of growth with increasing peptide concentrations. This means the peptide is still affecting growth even if it is not completely inhibiting it.

### Calculating the Area Under the Curve (AUC)

Perhaps to account for factors like changes in lag time, we could use area under the curve (AUC) to quantify growth over time. I will now do some work to acquire the AUC and visualize it.

**A function to calculate the AUC.**

```{r}
#| code-fold: true
calculatingarea <- function(data, i){
  #use area of a trapezoid equation to determine area between 2 points, then sum them up
  height <- lead(data$newtime) - data$newtime
  height <- as.numeric(height)  #it was returning it as a difftime object
  base1 <- data$OD600
  base2 <- lead(data$OD600)
  Area <- (base1 + base2)*height/2
  Area <- na.omit(Area)
  return(sum(Area))

}
```

**Storing the AUCs in a vector for all 96 wells:**

```{r}
#| code-fold: true

wellnums <- unique(long_OD_time_info$well)

areavector <- function(df){
  allareas <- c()
  for (i in 1:(nrow(df)/49)) {
    A <- df %>% 
           filter(well == wellnums[[i]]) %>% 
           calculatingarea(i)
    allareas <- c(allareas, A)
  }
  return(round(allareas, 2))
}
allareas <- areavector(long_OD_time_info)
print(allareas)
```

These are all the areas under each curve.

**Adding the AUCs to the original data frame**

```{r}
#| code-fold: true

#now I will add the area data to the original data frame to do some work with it.
long_OD_time_info <- long_OD_time_info %>% 
                       mutate(area = rep(allareas, 49)) 
#because area values correspond to the same order as well numbers, can just multiply them to match the same length. 
```

Double checking... the same well for all time points should have the same area.

```{r}
#| code-fold: true

long_OD_time_info %>% 
  filter(well == "A1") %>% 
  select(area) %>% 
  unique
```

This looks good, the area for A1 at all time points is 22.2

**Heatmap of AUC**

I will visualize this data using a heatmap to see if overall growth as represented by AUC is higher with lower drug concentrations and vise versa.

```{r}
#| code-fold: true
makeheatmap <- function(df, title){
  
#first I'm going to change the direction of the ampicillin factor, because I am used to visualizing checkerbaords with (0,0) in the top left corner.
  df$amp_uM <- factor(df$amp_uM, levels = rev(unique(df$amp_uM)))
  
  df%>% 
    ggplot(aes(x = pep_uM, y = amp_uM, fill = area)) +
    geom_tile() +
    scale_x_discrete(position = "top") +
    labs(x = "Peptide Concentration (uM)", y = "Ampicillin Concentration (uM)",
         title = title)
}

PB9_hmap <- makeheatmap(long_OD_time_info, 
            title = "Heatmap of area under the curve \nfor each well in a Checkerboard for TEM-1 \ncontaining E.coli PB9")
ggsave2(plot = PB9_hmap, filename = "plots/PB9_hmap.jpeg", width = 12, height = 8, units = "cm")
```

![](plots/PB9_hmap.jpeg){width="8in"} This gives the same visual as the growth curve really. There is less curve area as concentrations for both drugs increase. Overall, this supports the same conclusion as above: that the peptide is effectively inhibiting TEM-1 allowing ampicillin to inhibit bacterial growth.

#### Comparison of PB9 data to control MG1655 *E.coli* Strain.

Since a lot of the explanations for the data checking/wrangling have been done above, we will go faster for the control strain. Basically, for this checkerboard we want to see no response to peptide. Whereas for the above test strain we did want to see a response to peptide.

**Read in growth curve data for MG1655**

```{r}
#| code-fold: true
MG1655_gc <- read_csv("growthcurvedata/checkerboard_MG1655_amp_EP6_012325_input.csv", show_col_types = F)
names(MG1655_gc)
```

layout is the same as PB9 strain, with time, temperature and well columns.

**Removing Temp column, check for NAs and 49 time points:**.

```{r}
#| code-fold: true

MG1655_gc <- MG1655_gc[,-2] #remove Temp column because it's useless
checklength_and_NAs(MG1655_gc) #no NAs, all columns are 49 timepoints.
```

All good.

**Make newtime column, make long formatted table so it is tidy, and make 'column' and 'row' columns:**

```{r}
#| code-fold: true

MG1655_gc <- makenewtime(MG1655_gc)  #make newtime column
MG1655_gc <- pivotlong_gc(MG1655_gc) #pivot longer
MG1655_gc <- addcolumnrow(MG1655_gc) #add column and row columns
```

**Read in the drug concentrations for this file**

```{r}
#| code-fold: true

MG1655drugconcs <- read_csv("drugconcs/MG1655_drugconcs.csv", show_col_types = F) #read in drug concs
print(MG1655drugconcs) 
```

There are more NAs, this is becuase I did not use the first column and last column on the 96-well plate when I was doing the checkerboard. I will need to remove these NAs later.

**Add drug concs to the main MG1655 growth curve data frame:**

```{r}
#| code-fold: true

MG1655_gc <- adddrugconcs(MG1655_gc, MG1655drugconcs)  #looks good.
```

**Subtract background OD600:**

```{r}
#| code-fold: true

MG1655_gc$OD600 <- MG1655_gc$OD600 - bgOD$OD600
range(MG1655_gc$OD600) #looks good (a little below 0 is fine)
```

**Now we can remove the rows containing NAs**

```{r}
#| code-fold: true

MG1655_gc <- na.omit(MG1655_gc)
```

**Make control row and control column plots:**

```{r}
#| code-fold: true

makesinglerowplotamp(MG1655_gc, 
                   title = "24h growth curve of E.coli MG1655 control strain \ntreated without peptide")
```

MG16155 is responding as expected to ampicillin.

```{r}
#| code-fold: true

makesinglerowplotpep(MG1655_gc,
                     title = "24h growth curve of E.coli MG1655 control strain \ntreated without ampicillin")
```

I think this looks good. Regardless of the peptide concentration, the wells pretty much grow the same. This makes sense as there is no TEM-1 for the peptide to inhibit.

**Distributions of OD600 by drug concentration**

```{r}
#| code-fold: true

distributionbyamp(MG1655_gc,
                   title = "Distributions of OD600 for 24h growth curve \nof E.coli MG1655 control by ampicillin concentration")

distributionbypep(MG1655_gc,
                  title = "Distributions of OD600 for 24h growth curve \nof E.coli MG1655 control by peptide concentration")
```

I think the distribution of OD600 looks about the same for each concentration of peptide. This is good because it means our control strain is not responding to the peptide. Further supporting that the peptide is having an effect on our TEM-1 containing strain. Ampicillin has an effect on OD600 distribution with very minimal 0uM ampicillin being present at low OD600s and very little high (32uM) ampicillin concentration being present at low OD600. This is as expected, as the MG1655 strain should still be growing less in higher concentrations of ampicillin.

#### Growth Curves for MG1655 Checkerboard.

```{r}
#| code-fold: true
MG1655plot <- make_allwellgc(MG1655_gc,
                 title = "24h Growth curve of Checkerboard assay for MG1655 control strain.")
ggsave2(plot = MG1655plot, filename = "plots/MG1655_allwellplot.jpeg",  width = 24, height = 16, units = "cm")
```

![](plots/MG1655_allwellplot.jpeg) This one appears pretty consistent across the x axis, meaning the peptide is having little effect on growth (this is what we expect.) Growth is inhibited at 11-16uM of ampicillin which is a low amount that we would expect for a non-resistant strain of bacteria.

#### Doing AUC Analyses for MG1655

**Calculating AUC and adding to growth curve data**

```{r}
#| code-fold: true
wellnums <- unique(MG1655_gc$well)
MG1655areas <- areavector(MG1655_gc)
MG1655areas 
length(MG1655areas) 
range(MG1655areas)  #this all looks good.
MG1655_gc <- MG1655_gc %>%  mutate(area = rep(MG1655areas, 49))   #adding area to df
MG1655_gc %>% head()  #looks good
```

looks good.

**Make Heat Map for MG1655**

```{r}
#| code-fold: true
MG1655_hmap <- makeheatmap(MG1655_gc, 
                            title = "Heatmap of area under the curve \nfor each well in Checkerboard for MG1655 E.coli") 
ggsave2(plot = MG1655_hmap, filename = "plots/MG1655_hmap.jpeg", width = 12, height = 8, units = "cm")
```

![](plots/MG1655_hmap.jpeg){width="8in"} Overall, this supports the growth curve plot results that MG1655 is working expected as a control and that the peptide inhibits TEM-1 which is why there is no peptide effect on MG1655.

#### Comparing the PB9 and MG1655 Plots

::: {layout-ncol="2"}
![](plots/MG1655_allwellplot.jpeg){width="50%"}

![](plots/PB9_allwellplot.jpeg){width="50%"}
:::

::: {layout-ncol="2"}
![](plots/MG1655_hmap.jpeg)

![](plots/PB9_hmap.jpeg)
:::

Overall, for the TEM-1 containing strain, the peptide when combined with the ampicillin does seem to inhibit growth more than either drug alone as demonstrated by lower AUC at higher peptide concentration (when paired with amp.) This combined with the MG1655 control data which does not seem to respond to the peptide supports the claim that the peptide is in fact able to bind and inhibit TEM-1 in the PB9 test strain.

THE END :)
